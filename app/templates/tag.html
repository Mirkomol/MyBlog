{% extends "base.html" %}

{% block content %}
<div class="page-container">
    <h1 class="page-title">Posts tagged: <span class="tag-highlight">{{ tag.name }}</span></h1>

    {% if posts.items %}
    <div class="posts-list">
        {% for post in posts.items %}
        <article class="post-card">
            <a href="{{ url_for('blog.view_post', slug=post.slug) }}" class="post-card-link">
                <div class="post-card-content">
                    <div class="post-card-meta">
                        <span class="author">{{ blog_author }}</span>
                        <span class="separator">¬∑</span>
                        <span class="date">{{ post.published_at.strftime('%b %d') if post.published_at else 'Draft'
                            }}</span>
                    </div>
                    <h3 class="post-card-title">{{ post.title }}</h3>
                    <p class="post-card-excerpt">{{ post.excerpt or post.content[:150] | striptags }}...</p>
                    <div class="post-card-footer">
                        <div class="post-tags">
                            {% for t in post.tags[:3] %}
                            <span class="tag">{{ t.name }}</span>
                            {% endfor %}
                        </div>
                        <span class="reading-time">{{ post.reading_time }} min read</span>
                    </div>
                </div>
                {% if post.cover_image %}
                <div class="post-card-image">
                    <img src="{{ url_for('static', filename='uploads/' + post.cover_image) }}" alt="{{ post.title }}">
                </div>
                {% endif %}
            </a>
        </article>
        {% endfor %}
    </div>

    {% if posts.pages > 1 %}
    <nav class="pagination">
        {% if posts.has_prev %}
        <a href="{{ url_for('blog.posts_by_tag', slug=tag.slug, page=posts.prev_num) }}" class="pagination-btn">‚Üê
            Previous</a>
        {% endif %}
        <span class="pagination-info">Page {{ posts.page }} of {{ posts.pages }}</span>
        {% if posts.has_next %}
        <a href="{{ url_for('blog.posts_by_tag', slug=tag.slug, page=posts.next_num) }}" class="pagination-btn">Next
            ‚Üí</a>
        {% endif %}
    </nav>
    {% endif %}
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">üè∑Ô∏è</div>
        <h3>No posts with this tag</h3>
        <p>Check back soon for new content!</p>
        <a href="{{ url_for('blog.index') }}" class="btn btn-primary">Back to Home</a>
    </div>
    {% endif %}
</div>
{% endblock %}