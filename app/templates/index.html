{% extends "base.html" %}

{% block content %}
<div class="home-container">
    <!-- Hero Section with Featured Post -->
    {% if featured_post %}
    <section class="hero-section">
        <a href="{{ url_for('blog.view_post', slug=featured_post.slug) }}" class="featured-card">
            <div class="featured-image">
                {% if featured_post.cover_image %}
                <img src="{{ url_for('static', filename='uploads/' + featured_post.cover_image) }}"
                    alt="{{ featured_post.title }}">
                {% else %}
                <div class="featured-placeholder">
                    <span>‚ú¶</span>
                </div>
                {% endif %}
                <div class="featured-overlay"></div>
            </div>
            <div class="featured-content">
                <span class="featured-badge">Featured</span>
                <h1 class="featured-title">{{ featured_post.title }}</h1>
                <p class="featured-excerpt">{{ featured_post.excerpt or featured_post.content[:200] | striptags }}...
                </p>
                <div class="featured-meta">
                    <span class="author">{{ featured_post.author.username }}</span>
                    <span class="separator">¬∑</span>
                    <span class="date">{{ featured_post.published_at.strftime('%b %d, %Y') if featured_post.published_at
                        else 'Draft' }}</span>
                    <span class="separator">¬∑</span>
                    <span class="reading-time">{{ featured_post.reading_time }} min read</span>
                </div>
            </div>
        </a>
    </section>
    {% endif %}

    <!-- Main Content Grid -->
    <div class="content-grid">
        <!-- Posts Column -->
        <section class="posts-section">
            <h2 class="section-title">Latest Stories</h2>

            {% if posts.items %}
            <div class="posts-list">
                {% for post in posts.items %}
                <article class="post-card">
                    <a href="{{ url_for('blog.view_post', slug=post.slug) }}" class="post-card-link">
                        <div class="post-card-content">
                            <div class="post-card-meta">
                                <span class="author">{{ post.author.username }}</span>
                                <span class="separator">¬∑</span>
                                <span class="date">{{ post.published_at.strftime('%b %d') if post.published_at else
                                    'Draft' }}</span>
                            </div>
                            <h3 class="post-card-title">{{ post.title }}</h3>
                            <p class="post-card-excerpt">{{ post.excerpt or post.content[:150] | striptags }}...</p>
                            <div class="post-card-footer">
                                <div class="post-tags">
                                    {% for tag in post.tags[:3] %}
                                    <span class="tag">{{ tag.name }}</span>
                                    {% endfor %}
                                </div>
                                <span class="reading-time">{{ post.reading_time }} min read</span>
                            </div>
                        </div>
                        {% if post.cover_image %}
                        <div class="post-card-image">
                            <img src="{{ url_for('static', filename='uploads/' + post.cover_image) }}"
                                alt="{{ post.title }}">
                        </div>
                        {% endif %}
                    </a>
                </article>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if posts.pages > 1 %}
            <nav class="pagination">
                {% if posts.has_prev %}
                <a href="{{ url_for('blog.index', page=posts.prev_num) }}" class="pagination-btn">
                    ‚Üê Previous
                </a>
                {% endif %}

                <span class="pagination-info">Page {{ posts.page }} of {{ posts.pages }}</span>

                {% if posts.has_next %}
                <a href="{{ url_for('blog.index', page=posts.next_num) }}" class="pagination-btn">
                    Next ‚Üí
                </a>
                {% endif %}
            </nav>
            {% endif %}
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">üìù</div>
                <h3>No posts yet</h3>
                <p>Check back soon for new content!</p>
            </div>
            {% endif %}
        </section>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Tags Cloud -->
            {% if tags %}
            <div class="sidebar-card">
                <h3 class="sidebar-title">Discover Topics</h3>
                <div class="tags-cloud">
                    {% for tag in tags %}
                    <a href="{{ url_for('blog.posts_by_tag', slug=tag.slug) }}" class="tag-link">
                        {{ tag.name }}
                    </a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- About Card -->
            <div class="sidebar-card about-card">
                <h3 class="sidebar-title">About</h3>
                <p>{{ blog_subtitle }}</p>
                <a href="{{ url_for('blog.about') }}" class="link-arrow">Learn more ‚Üí</a>
            </div>
        </aside>
    </div>
</div>
{% endblock %}